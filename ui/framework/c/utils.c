#include "../tools.h"

//:::::::::::::::::::::::
int propMapB[26][3] = {
  { 11,  12, 33},
  { 49,  12, 31},
  { 85,  12, 31},
  {120,  12, 30},
  {156,  12, 21},
  {183,  12, 21},
  {207,  12, 32},

  { 13,  55, 30},
  { 49,  55, 13},
  { 66,  55, 29},
  {101,  55, 31},
  {135,  55, 21},
  {158,  55, 40},
  {204,  55, 32},

  { 12,  97, 31},
  { 48,  97, 31},
  { 82,  97, 30},
  {118,  97, 30},
  {153,  97, 30},
  {185,  97, 25},
  {213,  97, 30},
  { 11, 139, 32},
  { 42, 139, 51},
  { 93, 139, 32},
  {126, 139, 31},
  {158, 139, 25},
};
//:::::::::::::::::::::::
int propMap[128][3] = {
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0,               -1},
  {  0,   0, PROP_SPACE_WIDTH}, // SPACE
  { 11, 122,                7}, // !
  {154, 181,               14}, // "
  { 55, 122,               17}, // #
  { 79, 122,               18}, // $
  {101, 122,               23}, // %
  {153, 122,               18}, // &
  {  9,  93,                7}, // '
  {207, 122,                8}, // (
  {230, 122,                9}, // )
  {177, 122,               18}, // *
  { 30, 152,               18}, // +
  { 85, 181,                7}, // ,
  { 34,  93,               11}, // -
  {110, 181,                6}, // .
  {130, 152,               14}, // /

  { 22,  64,               17}, // 0
  { 41,  64,               12}, // 1
  { 58,  64,               17}, // 2
  { 78,  64,               18}, // 3
  { 98,  64,               19}, // 4
  {120,  64,               18}, // 5
  {141,  64,               18}, // 6
  {204,  64,               16}, // 7
  {162,  64,               17}, // 8
  {182,  64,               18}, // 9
  { 59, 181,                7}, // :
  { 35, 181,                7}, // ;
  {203, 152,               14}, // <
  { 56,  93,               14}, // =
  {228, 152,               14}, // >
  {177, 181,               18}, // ?

  { 28, 122,               22}, // @
  {  5,   4,               18}, // A
  { 27,   4,               18}, // B
  { 48,   4,               18}, // C
  { 69,   4,               17}, // D
  { 90,   4,               13}, // E
  {106,   4,               13}, // F
  {121,   4,               18}, // G
  {143,   4,               17}, // H
  {164,   4,                8}, // I
  {175,   4,               16}, // J
  {195,   4,               18}, // K
  {216,   4,               12}, // L
  {230,   4,               23}, // M
  {  6,  34,               18}, // N
  { 27,  34,               18}, // O

  { 48,  34,               18}, // P
  { 68,  34,               18}, // Q
  { 90,  34,               17}, // R
  {110,  34,               18}, // S
  {130,  34,               14}, // T
  {146,  34,               18}, // U
  {166,  34,               19}, // V
  {185,  34,               29}, // W
  {215,  34,               18}, // X
  {234,  34,               18}, // Y
  {  5,  64,               14}, // Z
  { 60, 152,                7}, // [
  {106, 151,               13}, // '\'
  { 83, 152,                7}, // ]
  {128, 122,               17}, // ^
  {  4, 152,               21}, // _

  {134, 181,                5}, // '
  {  5,   4,               18}, // A
  { 27,   4,               18}, // B
  { 48,   4,               18}, // C
  { 69,   4,               17}, // D
  { 90,   4,               13}, // E
  {106,   4,               13}, // F
  {121,   4,               18}, // G
  {143,   4,               17}, // H
  {164,   4,                8}, // I
  {175,   4,               16}, // J
  {195,   4,               18}, // K
  {216,   4,               12}, // L
  {230,   4,               23}, // M
  {  6,  34,               18}, // N
  { 27,  34,               18}, // O

  { 48,  34,               18}, // P
  { 68,  34,               18}, // Q
  { 90,  34,               17}, // R
  {110,  34,               18}, // S
  {130,  34,               14}, // T
  {146,  34,               18}, // U
  {166,  34,               19}, // V
  {185,  34,               29}, // W
  {215,  34,               18}, // X
  {234,  34,               18}, // Y
  {  5,  64,               14}, // Z
  {153, 152,               13}, // {
  { 11, 181,                5}, // |
  {180, 152,               13}, // }
  { 79,  93,               17}, // ~
  {  0,   0,               -1}  // DEL
};
//::::::::::::::::::::::::::


//::::::::::::::::::::::::::
// Com_Printf
void QDECL Com_Printf(const char* msg, ...) {
  va_list argptr;
  char    text[1024];
  va_start(argptr, msg);
  Q_vsnprintf(text, sizeof(text), msg, argptr);
  va_end(argptr);
  id3Print(text);
}
//::::::::::::::::::::::::::
// Com_Error
void QDECL Com_Error(int level, const char* error, ...) {
  va_list argptr;
  char    text[1024];
  va_start(argptr, error);
  Q_vsnprintf(text, sizeof(text), error, argptr);
  va_end(argptr);
  id3Error(text);
}
//::::::::::::::::::::::::::

//:::::::::::::::::
// Callback Utils
int Passf(float x) {
  floatint_t fi;
  fi.f = x;
  return fi.i;
}
//:::::::::::::::::

//:::::::::::::::::::::::
// uiAdjustFrom640
//   Adjusted for resolution and screen aspect ratio
//:::::::::::::::::::::::
void uiAdjustFrom640(float* x, float* y, float* w, float* h) {
  *x = *x * uis.xscale + uis.bias;
  *y *= uis.yscale;
  *w *= uis.xscale;
  *h *= uis.yscale;
}
//:::::::::::::::::::::::
// uiLerpColor
//:::::::::::::::::::::::
void uiLerpColor(vec4_t a, vec4_t b, vec4_t c, float t) {
  // lerp and clamp each component
  for (int i = 0; i < 4; i++) {
    c[i] = a[i] + t * (b[i] - a[i]);
    if (c[i] < 0) c[i] = 0;
    else if (c[i] > 1.0) c[i] = 1.0;
  }
}
//:::::::::::::::::::::::
// uiSetColor
//:::::::::::::::::::::::
void uiSetColor(const float* rgba) { id3R_SetColor(rgba); }


//:::::::::::::::::::::::
float uiPSizeScale(int style) {
  if (style & UI_SMALLFONT) { return PROP_SMALL_SIZE_SCALE; }
  return 1.00;
}
//:::::::::::::::::::::::
// uiPStringWidth
//::::::::::::::::::::::::::
int uiPStringWidth(const char* str) {
  const char* s     = str;
  int         width = 0;
  int         charWidth;
  int         ch;
  while (*s) {
    ch        = *s & 127;
    charWidth = propMap[ch][2];
    if (charWidth != -1) {
      width += charWidth;
      width += PROP_GAP_WIDTH;
    }
    s++;
  }
  width -= PROP_GAP_WIDTH;
  return width;
}
//:::::::::::::::::::::::
